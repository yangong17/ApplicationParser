
{% extends "layout.html" %}

{% block content %}


<h2>Form Parser V1.0</h2>
<p style="margin-top: 20px; margin-bottom: 50px;">Employee Information Sheets → Data Extraction → Exported as .csv</p>

    

<form action="/jobinformation" style="margin-top: 40px; margin-bottom: 40px;" method="post">
    <h4>1. Input Job Information</h4>
    <p>Enter details of job to compare applications to:</p>


    <div>
        <label for="jobTitle">Job Title:</label>
        <input type="text" id="jobTitle" name="jobTitle" required>
    </div>

    <div>
        <label for="yearsOfExperience">Years of Experience:</label>
        <input type="number" id="yearsOfExperience" name="yearsOfExperience" required>
    </div>

    <div>
        <label for="jobLocation">Job Address:</label>
        <input type="text" id="jobLocation" name="jobLocation" style="width: 50%;" required>
    </div>

    <div>
        <label for="salary">Annual Salary:</label>
        <input type="number" id="salary" name="salary" required>
    </div>

    <div>
        <label for="keyWords">Job Duties and Responsibilties:</label><br>
        <textarea id="keyWords" name="keyWords" rows="4" cols="50" required></textarea>
    </div>

    <div>
        <input type="submit" value="Submit">
    </div>
</form>

<!-- Confirmation Message -->
{% if infomsg %}
<p class="alert alert-success mt-3">{{ infomsg }}</p>
{% endif %}


<form action="/upload" style="margin-top: 40px; margin-bottom: 40px;" method="post" enctype="multipart/form-data">
    
    <h4>2. Upload Job Applications</h4>


    <!-- Upload PDF -->
    <div class="form-group">
        <input type="file" class="form-control-file" id="pdf" name="file" accept=".pdf">
    </div>

    <!-- Submit Button for Upload -->
    <input type="submit" name="upload" value="Upload" class="btn btn-success">

</form>

<!-- Confirmation Message -->
{% if uploadmsg %}
<p class="alert alert-success mt-3">{{ uploadmsg }}</p>
<script>
    $("#pdf").attr("disabled", "disabled");  // Disable the file input
    $("input[type='submit']").attr("disabled", "disabled");  // Disable the upload button
</script>
{% endif %}


<form action="/execute" style="margin-top: 40px; margin-bottom: 40px;" method="post" enctype="multipart/form-data">
   
    <h4>Find Best Matches</h4>

    <!-- Button to run Analysis -->
    <button id="executeBtn" class="btn btn-secondary mt-3">Analyze</button>

</form>

<!-- Confirmation Message -->
{% if executemsg %}
<p class="alert alert-success mt-3">{{ executemsg }}</p>
{% endif %}

<!-- Review Data -->
<form action="/analyze" style="margin-top: 40px; margin-bottom: 40px;" method="post" enctype="multipart/form-data">
    <h4>View Database</h4>
    <!-- Button to view database data -->
    <button id="analyzeBtn" class="btn btn-secondary mt-3">View Database</button>
</form>

<!-- Placeholder for the extracted data table -->
<div id="dataTableContainer" style="margin-top: 40px; margin-bottom: 40px;">
    <h4>Extracted Data:</h4>
    <table class="table table-bordered" id="extractedDataTable">
        <thead>
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Years of Experience</th>
                <th>Previous Job</th>
                <th>Relevant Skills</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<script>
    $(document).ready(function(){
        $("#analyzeBtn").click(function(event){
            // Prevent the default form submission
            event.preventDefault();

            // Send a POST request to /analyze
            $.post("/analyze", function(data){
                // Clear the existing rows in the table
                $("#extractedDataTable tbody").empty();

                // Loop through each row of data
                $.each(data, function(index, row){
                    // Create a new table row
                    let tr = $("<tr>");
                    
                    // Append columns to the row
                    tr.append($("<td>").text(row.first_name));
                    tr.append($("<td>").text(row.last_name));
                    tr.append($("<td>").text(row.years_of_experience));
                    tr.append($("<td>").text(row.previous_job));
                    tr.append($("<td>").text(row.your_relevant_skills));

                    // Append the row to the table body
                    $("#extractedDataTable tbody").append(tr);
                });
            });
        });
    });
</script>


<!-- Download File Button -->
<div class="mt-3">
    <a href="/download/filename_here" class="btn btn-success">Download Processed File</a>
</div>



{% endblock %}
